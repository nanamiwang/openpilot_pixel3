//#define RAW_FRAME_WIDTH 4032
//#define RAW_FRAME_HEIGHT 3024
#define RAW_FRAME_WIDTH 2016
#define RAW_FRAME_HEIGHT 1512

//#define ENABLE_HDR

struct i2c_random_wr_payload start_reg_array_imx363[] = {
// CAM_SENSOR_PACKET_OPCODE_SENSOR_STREAMON
{0x0100, 0x1},
};

struct i2c_random_wr_payload stop_reg_array[] = {
// CAM_SENSOR_PACKET_OPCODE_SENSOR_STREAMOFF
{0x0100, 0x0},
};

struct i2c_random_wr_payload init_array_imx363[] = {

// /vendor/media/ensemble_fd_model.emd
// CAM_SENSOR_PACKET_OPCODE_SENSOR_INITIAL_CONFIG
{0x0136, 0x18},
{0x0137, 0x0},
{0x31a3, 0x0},
{0x64d4, 0x1},
{0x64d5, 0xaa},
{0x64d6, 0x1},
{0x64d7, 0xa9},
{0x64d8, 0x1},
{0x64d9, 0xa5},
{0x64da, 0x1},
{0x64db, 0xa1},
{0x720a, 0x24},
{0x720b, 0x89},
{0x720c, 0x85},
{0x720d, 0xa1},
{0x720e, 0x6e},
{0x729c, 0x59},
{0x817c, 0xff},
{0x817d, 0x80},
{0x9348, 0x96},
{0x934b, 0x8c},
{0x934C, 0x82},
{0x9353, 0xAA},
{0x9354, 0xAA},
{0x5872, 0x0},
{0x5873, 0xC},
{0x4B67, 0xFF},
{0x4BD0, 0x0},
{0x138, 0x0},
{0x5D0C, 0x1},

// /persist/camera/LED_AWB_Cal.cal
// /persist/camera/AWB_calibration.cal
// CAM_SENSOR_PACKET_OPCODE_SENSOR_CONFIG
{0x0112, 0xa},
{0x0113, 0xa},
{0x0114, 0x3},
#ifdef ENABLE_HDR
{0x0220, 0x1}, // HDR mode
{0x3010, 0x66}, // HDR_OUTPUT_CTRL = ATR + HDR compose + DPC1D + DCP2D
{0x3011, 0x01}, // HDR_OUTPUT_CTRL2 = PD enable
{0x30c0, 0x11}, // RED_GAIN_CB?
{0x300d, 0x00}, // FORCE_FDSUM = disable
{0x30fd, 0x00},
{0x8493, 0x00},
{0x8863, 0x00},
{0x90d7, 0x19},
{0x0222, 0x10}, // EXPO_RATIO = 16
#else
{0x0220, 0x0},
#endif
{0x0221, 0x11},

{0x0340, 0xc}, {0x0341, 0x38}, // FRM_LENGTH  = frame_length_lines = 0xc38 = 3128
{0x0342, 0x16}, {0x0343, 0xf8},  // LINE_LENGTH = line_length_pclk = 0x16f8 = 5880
{0x0381, 0x1},
{0x0383, 0x1},
{0x0385, 0x1},
{0x0387, 0x1},
#if RAW_FRAME_WIDTH == 2016
{0x0900, 0x01}, // BINNING_MODE
{0x0901, 0x22}, // BINING_TYPE_H/V
{0x30F4, 0x02},
{0x30F5, 0xBC},
{0x30F6, 0x01},
{0x30F7, 0x18},
{0x31A0, 0x02},
{0x31A5, 0x00},
{0x31A6, 0x01},
#else
{0x0900, 0x0},
{0x0901, 0x11},
{0x30f4, 0x1},
{0x30f5, 0xf4},
{0x30f6, 0x0},
{0x30f7, 0x14},
{0x31a0, 0x0},
{0x31a5, 0x0},
{0x31a6, 0x0},
#endif

{0x560f, 0x64},
{0x5856, 0x8},
{0x58d0, 0x10},
{0x734a, 0x1},
{0x734f, 0x2b},
{0x7441, 0x55},
{0x7914, 0x3},
{0x7928, 0x4},
{0x7929, 0x4},
{0x793f, 0x3},
{0xbc7b, 0x18},
{0x0344, 0x0},
{0x0345, 0x0},
{0x0346, 0x0},
{0x0347, 0x0},
{0x0348, 0xf},
{0x0349, 0xbf},
{0x034a, 0xb},
{0x034b, 0xcf},

{0x034c, RAW_FRAME_WIDTH >> 8}, // X_OUT_SIZE high
{0x034d, RAW_FRAME_WIDTH & 0xFF}, // X_OUT_SIZE low
{0x034e, RAW_FRAME_HEIGHT >> 8}, // Y_OUT_SIZE high
{0x034f, RAW_FRAME_HEIGHT & 0xFF}, // Y_OUT_SIZE low

{0x0101, 0x3},
{0x0408, 0x0},
{0x0409, 0x0},
{0x040a, 0x0},
{0x040b, 0x0},
{0x040c, RAW_FRAME_WIDTH >> 8}, // DCROP_WIDTH
{0x040d, RAW_FRAME_WIDTH & 0xFF}, // DCROP_WIDTH
{0x040e, RAW_FRAME_HEIGHT >> 8}, // DCROP_HEIGHT
{0x040f, RAW_FRAME_HEIGHT & 0xFF}, // DCROP_HEIGHT

// Clock settings
#if RAW_FRAME_WIDTH == 2016
{0x0301, 0x03},
{0x0303, 0x02},
{0x0305, 0x04},
{0x0306, 0x00}, {0x0307, 0x46},
{0x0309, 0x0A},
{0x030b, 0x04},
{0x030d, 0x03},
{0x030e, 0x00}, {0x030f, 0xC2},
{0x0310, 0x01},
#else
{0x0301, 0x3}, // VT_PIX_CLK_DIV
{0x0303, 0x2}, // VT_SYS_CLK_DIV
{0x0305, 0x4}, // PRE_PLL_CLK_DIV
{0x0306, 0x0}, {0x0307, 0x8a}, // PLL_MULTIPLIER
{0x0309, 0xa}, // OP_PIX_CLK_DIV
{0x030b, 0x1}, // OP_SYS_CLK_DIV
{0x030d, 0x4}, // PREPLLCK_OP_DIV
{0x030e, 0x0}, {0x030f, 0xe4}, // PLL_OP_MPY
{0x0310, 0x1}, // PLL_MULT_DRIV
#endif

{0x0202, 0xc}, {0x0203, 0x28}, // INTEG_TIME
{0x0224, 0x1}, {0x0225, 0xf4}, // ST_COARSE_INTEG_TIME = 506
{0x0226, 0x0}, {0x0227, 0x0},

// CAM_SENSOR_PACKET_OPCODE_SENSOR_CONFIG
{0x780f, 0x0},
{0x0600, 0x0},
{0x0601, 0x0},

// /persist/camera/rals_fac_test
// CAM_SENSOR_PACKET_OPCODE_SENSOR_CONFIG
{0x0104, 0x1},
{0x0340, 0xc}, {0x0341, 0x38}, // FRM_LENGTH  = frame_length_lines = 0xc38
{0x3008, 0x0},
{0x0104, 0x0},

// CAM_SENSOR_PACKET_OPCODE_SENSOR_UPDATE
{0x0104, 0x1},
#if RAW_FRAME_WIDTH == 2016
{0x0340, 0x08}, {0x0341, 0x58}, // FRM_LENGTH
{0x0342, 0x11}, {0x0343, 0x10}, // LINE_LENGTH
#else
{0x0340, 0xc}, {0x0341, 0x38}, // FRM_LENGTH  = frame_length_lines = 0xc38
{0x0342, 0x16}, {0x0343, 0xf8},  // LINE_LENGTH
#endif

// INTEG_TIME aka coarse_int_time_addr aka shutter speed
// ACAMERA_SENSOR_EXPOSURE_TIME = 1000000000L/100
//  {0x202, 0x3}, {0x203, 0xA8}, 1/0x3A8 = 0.0010683760683760685
// ACAMERA_SENSOR_EXPOSURE_TIME = 1000000000L/50
//   {0x202, 0x7}, {0x203, 0x54}, 1/0x754 = 0.0005330490405117271
// ACAMERA_SENSOR_EXPOSURE_TIME = 1000000000L/60
//   {0x202, 0x6}, {0x203, 0x1c}, 1/0x61C = 0.000646830530401035
// https://github.com/jingpad-bsp/vendor_sprd_modules_libcamera/blob/b85f7eb951b943caad890752ff249960faa20201/sensor/sensor_drv/classic/Sony/imx363/sensor_imx363_mipi_raw.h
//   1280x720 : {0x202, 0x4}, {0x203, 0x1E}, 1/0x41e = 0.0009487666034155598
//   2016x1512 : {0x202, 0x8}, {0x203, 0x4A}, 1/0x84A = 0.000471253534401508
//   4032x3024 : {0x202, 0xC}, {0x203, 0x26}, 1/0xC26 = 0.0003215434083601286
{0x0202, 0x6}, {0x0203, 0x20}, // INTEG_TIME = 0x620 = 1568

// gain settings
{0x0204, 0x0}, {0x0205, 0x0},  // ANA_GAIN_GLOBAL = 512 / (512 - X)
//{0x0204, 0x1}, {0x0205, 0x83}, // ANA_GAIN_GLOBAL = 512 / (512 - X)
{0x0216, 0x0}, {0x0217, 0x0}, // ST_ANA_GAIN_GLOBAL[8]
{0x020e, 0x1}, {0x020f, 0x0}, // DIG_GAIN_GR
//{0x020e, 0x1}, {0x020f, 0xCC}, // DIG_GAIN_GR
{0x0210, 0x01}, {0x0211, 0x00}, // DIG_GAIN_R
{0x0212, 0x01}, {0x0213, 0x00}, // DIG_GAIN_B
{0x0214, 0x01}, {0x0215, 0x00}, // DIG_GAIN_GB

#ifdef ENABLE_HDR
// HDR white balance settings (ABS_GAIN)
{0xb8e, 0x01}, {0xb8f, 0x00}, // GR
{0xb90, 0x02}, {0xb91, 0x2b}, // R
{0xb92, 0x01}, {0xb93, 0xd4}, // B
{0xb94, 0x01}, {0xb95, 0x00}, // GB
#endif

{0x3008, 0x0},
{0x0104, 0x0},  //Hold
};
